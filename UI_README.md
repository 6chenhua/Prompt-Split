# 🤖 AI提示词智能拆分工具 - Web界面

现代化的Web界面，提供直观的用户体验和实时处理进度显示。

## 🚀 快速开始

### 方法1: 一键启动（推荐）
```bash
python start_ui.py
```

### 方法2: 手动启动
```bash
# 1. 安装依赖
pip install streamlit>=1.28.0

# 2. 启动界面
streamlit run ui_streamlit.py
```

启动后会自动打开浏览器访问 `http://localhost:8501`

## 🔑 API配置

### 首次使用配置

1. **获取API Key**
   - **Claude (推荐)**: 访问 [console.anthropic.com](https://console.anthropic.com)
   - **OpenAI**: 访问 [platform.openai.com](https://platform.openai.com)
   - **其他服务**: 查看相应文档

2. **配置步骤**
   ```
   1. 点击 "🔧 配置API" 按钮
   2. 输入您的API Key
   3. 选择合适的模型
   4. 点击 "🧪 测试连接" 验证
   5. 点击 "💾 保存配置" 完成
   ```

3. **安全说明**
   - API Key仅在浏览器会话中使用
   - 不会上传到服务器或永久存储
   - 关闭浏览器后需要重新输入

### 支持的服务商

| 服务商 | 推荐模型 | 获取地址 |
|--------|----------|----------|
| Anthropic Claude | claude-3-sonnet-20240229 | console.anthropic.com |
| OpenAI GPT | gpt-4-turbo | platform.openai.com |
| 其他兼容服务 | 自定义 | 查看服务商文档 |

## 📱 界面功能

### 🎯 主要功能区域

1. **🔑 API配置**
   - 支持Claude (Anthropic)、GPT (OpenAI)等多种AI服务
   - 安全的API Key管理（仅会话期间有效）
   - 连接测试功能
   - 自定义API服务器和模型选择

2. **📝 输入配置**
   - 文本输入：直接粘贴提示词内容
   - 文件上传：支持 `.txt` 和 `.md` 文件
   - 处理配置：分块大小、并发数、调试选项

3. **📊 实时进度显示**
   - 整体进度条
   - 当前步骤状态
   - 详细步骤列表
   - 可选的详细日志

4. **📋 结果展示**
   - 统计信息卡片
   - 多选项卡结果视图
   - 一键导出功能

### 🔄 处理流程

界面会实时显示以下处理步骤：

1. **输入验证** - 验证文本内容
2. **文本分块** - 按配置大小分割文本
3. **提取变量** - 使用LLM并发提取变量
4. **后处理变量** - 清理和标准化变量
5. **生成Mermaid图** - 创建流程图
6. **拆分子系统** - 识别功能子系统
7. **生成子提示词** - 为各子系统生成提示词
8. **转换CNLP** - 转换为结构化格式
9. **整合结果** - 生成最终输出

## 📊 结果查看

### 🔤 提取变量选项卡
- 显示所有提取的变量
- 查看变量标记后的文本
- 变量统计信息

### 🧩 子系统拆分选项卡
- 子系统详细信息
- 包含模块列表
- 职责和独立性说明
- Mermaid流程图代码

### 📝 CNLP结果选项卡
- 结构化的CNLP输出
- JSON格式详细信息
- 转换统计信息

### 🔗 协作关系选项卡
- 系统间协作关系
- 数据流向说明
- 后续将支持交互式流程图

## ⚙️ 配置选项

| 参数 | 说明 | 推荐值 | 范围 |
|------|------|--------|------|
| 分块大小 | 单个文本块的字符数 | 500 | 100-2000 |
| 并发数 | LLM并发请求数量 | 5 | 1-10 |
| 显示详细日志 | 是否显示处理细节 | 否 | 开/关 |

## 💾 结果导出

处理完成后可以导出：

1. **📄 JSON结果** - 包含完整处理结果的JSON文件
2. **📊 处理报告** - Markdown格式的汇总报告

## 🔧 技术特性

### 🌟 现代化界面
- 响应式设计，适配各种屏幕
- 优雅的渐变色彩方案
- 直观的图标和状态指示
- 流畅的动画效果

### ⚡ 性能优化
- 异步处理，避免界面卡顿
- 智能进度跟踪
- 内存高效的数据处理
- 自动错误恢复

### 🛡️ 错误处理
- 详细的错误信息显示
- 多策略JSON解析
- 网络异常重试机制
- 优雅的降级处理

## 🔍 故障排除

### 常见问题

**Q: 界面无法启动？**
A: 检查Python版本（需要3.7+）和网络连接，运行 `pip install -r requirements.txt`

**Q: 处理过程中卡住？**
A: 检查API配置和网络连接，查看详细日志了解具体问题

**Q: 结果不准确？**
A: 尝试调整分块大小，或检查输入文本格式

**Q: 内存使用过高？**
A: 减少并发数和分块大小，处理大文件时分批进行

### 调试技巧

1. **启用详细日志** - 勾选"显示详细日志"查看处理细节
2. **检查配置** - 确认 `config.json` 中的API配置正确
3. **分步测试** - 使用小段文本测试各个功能
4. **查看控制台** - 浏览器开发者工具中查看错误信息

## 📈 性能建议

### 针对不同使用场景

**📄 小文本（< 1000字符）**
- 分块大小：300-500
- 并发数：3-5
- 预期处理时间：30-60秒

**📖 中等文本（1000-5000字符）**
- 分块大小：500-800
- 并发数：5-7
- 预期处理时间：1-3分钟

**📚 大文本（> 5000字符）**
- 分块大小：800-1000
- 并发数：3-5（避免API限制）
- 预期处理时间：3-10分钟

## 🔄 更新日志

### v1.0.0 (当前版本)
- ✅ 完整的Web界面实现
- ✅ 实时进度显示
- ✅ 多策略JSON解析
- ✅ 结果导出功能
- ✅ 错误处理和重试机制

### 🚧 计划功能
- 🔜 交互式Mermaid流程图渲染
- 🔜 批量文件处理
- 🔜 处理历史记录
- 🔜 自定义模板支持
- 🔜 多语言界面

## 📞 技术支持

如果遇到问题，请：

1. 查看本文档的故障排除部分
2. 检查 `config.json` 配置
3. 查看详细日志输出
4. 提供错误信息和处理的文本示例

---

**提示**: 首次使用建议用较小的测试文本熟悉界面和流程，确认一切正常后再处理重要内容。 